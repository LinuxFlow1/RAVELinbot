<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{{ room.title }} - Rave Bot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='webapp/tgstyle.css') }}">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Jinja –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ —Ç–∏–ø–∞
        var userIdStr = "{{ user_id }}";
        var roomIdStr = "{{ room.id }}";
        var isCreatorStr = "{% if is_creator %}true{% else %}false{% endif %}";
        var isBannedStr = "{% if is_banned %}true{% else %}false{% endif %}";
        var botUsername = "{{ bot_username|default('your_bot_username') }}";
    </script>
</head>
<body data-room-id="{{ room.id }}" 
      data-room-title="{{ room.title }}" 
      data-is-creator="{% if is_creator %}true{% else %}false{% endif %}" 
      data-is-banned="{% if is_banned %}true{% else %}false{% endif %}" 
      data-user-id="{{ user_id }}" 
      data-bot-username="{{ bot_username|default('') }}">
    <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram WebApp -->
    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
        document.body.className = tg.colorScheme;
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        const userId = parseInt(userIdStr, 10);
        const roomId = roomIdStr;
        const isCreator = (isCreatorStr === "true");
        const isBanned = (isBannedStr === "true");
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
        tg.BackButton.show();
        tg.BackButton.onClick(function() {
            window.location.href = "/webapp?user_id=" + userId;
        });
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫–æ–º–Ω–∞—Ç—ã
        if (isCreator) {
            tg.MainButton.setText('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–æ–π');
            tg.MainButton.show();
        }
    </script>

    <div class="container">
        <div class="header">
            <h1 class="header-title">{{ room.title }}</h1>
            <p class="header-subtitle">
                –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {{ room.viewers|length }}
                {% if is_creator %}<span class="creator-badge"> ‚Ä¢ –í—ã —Å–æ–∑–¥–∞—Ç–µ–ª—å</span>{% endif %}
            </p>
        </div>

        {% if need_vpn %}
        <div class="vpn-warning">
            <div class="vpn-warning-title">‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: YouTube-–∫–æ–Ω—Ç–µ–Ω—Ç</div>
            <p class="vpn-warning-text">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç—Ç–æ–≥–æ –≤–∏–¥–µ–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤–∫–ª—é—á–∏—Ç—å VPN –∏–ª–∏ ByeDPI.</p>
        </div>
        {% endif %}

        <!-- –ë–ª–æ–∫ —Å –≤–∏–¥–µ–æ -->
        <div class="video-container" id="video-container" data-video-url="{{ room.video_url }}">
            <iframe src="{{ room.video_url }}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ -->
        <div class="video-controls">
            <button id="sync-btn" class="tg-button">
                <span class="icon-sync"></span> –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
            </button>
            
            {% if is_creator %}
            <button id="change-video-btn" class="tg-button primary">
                <span class="icon-change"></span> –°–º–µ–Ω–∏—Ç—å –≤–∏–¥–µ–æ
            </button>
            {% endif %}
        </div>

        <!-- –ß–∞—Ç –∫–æ–º–Ω–∞—Ç—ã -->
        <h2 class="section-title">–ß–∞—Ç –∫–æ–º–Ω–∞—Ç—ã</h2>
        
        <div class="chat-container">
            <div class="chat-messages" id="chat-messages">
                {% if room.messages %}
                    {% for message in room.messages %}
                        <div class="message {% if message.user_id == user_id %}outgoing{% endif %}" data-timestamp="{{ message.timestamp }}" data-user-id="{{ message.user_id }}">
                            <div class="message-bubble">{{ message.text }}</div>
                            <div class="message-info">
                                {{ message.user_name }}, {{ message.timestamp|format_time }}
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-chat-message">
                        –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞
                    </div>
                {% endif %}
            </div>
            
            <form class="chat-input" id="chat-form" {% if is_banned %}disabled{% endif %}>
                <input type="text" id="message-input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." {% if is_banned %}disabled{% endif %}>
                <button type="submit" {% if is_banned %}disabled{% endif %}>
                    <span class="icon-send">üì§</span>
                </button>
            </form>
        </div>
        
        {% if is_banned %}
        <div class="banned-message">
            ‚õî –í—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ —ç—Ç–æ–π –∫–æ–º–Ω–∞—Ç–µ –∏ –Ω–µ –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è.
        </div>
        {% endif %}
        
        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –¥—Ä—É–∑–µ–π -->
        <div class="invite-section">
            <button id="share-btn" class="tg-button primary wide-button">
                <span class="icon-share">üîó</span> –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π
            </button>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ -->
    <div class="modal" id="change-video-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°–º–µ–Ω–∏—Ç—å –≤–∏–¥–µ–æ</h2>
                <button class="close-btn" id="close-video-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="change-video-form">
                    <div class="form-group">
                        <label for="new_video_url">–°—Å—ã–ª–∫–∞ –Ω–∞ –Ω–æ–≤–æ–µ –≤–∏–¥–µ–æ</label>
                        <input type="text" id="new_video_url" name="new_video_url" class="tg-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ" required>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="tg-button primary">–û–±–Ω–æ–≤–∏—Ç—å –≤–∏–¥–µ–æ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
        document.getElementById('share-btn').addEventListener('click', function() {
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
            const shareText = `–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É –≤ Rave Bot!\n\n–ö–æ–º–Ω–∞—Ç–∞: {{ room.title }}\nID: {{ room.id }}\n\nhttps://t.me/${botUsername}?start=join_{{ room.id }}`;
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ Telegram WebApp –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞
            tg.switchInlineQuery(shareText, ['users', 'groups']);
        });
        
        // –ö–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫–æ–º–Ω–∞—Ç—ã
        if (isCreator) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            tg.MainButton.onClick(function() {
                document.getElementById('change-video-modal').classList.add('show');
            });
            
            // –ö–Ω–æ–ø–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ
            document.getElementById('change-video-btn').addEventListener('click', function() {
                document.getElementById('change-video-modal').classList.add('show');
            });
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            document.getElementById('close-video-modal-btn').addEventListener('click', function() {
                document.getElementById('change-video-modal').classList.remove('show');
            });
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ
            document.getElementById('change-video-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                tg.MainButton.showProgress();
                
                const new_video_url = document.getElementById('new_video_url').value;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ
                fetch('/webapp/update_video', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        room_id: roomId,
                        video_url: new_video_url,
                        user_id: userId
                    })
                })
                .then(response => response.json())
                .then(data => {
                    // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                    tg.MainButton.hideProgress();
                    
                    if (data.success) {
                        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                        document.getElementById('change-video-modal').classList.remove('show');
                        
                        // –ï—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ YouTube, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ VPN
                        if (data.need_vpn) {
                            tg.showAlert('‚ö†Ô∏è –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ YouTube –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å VPN –∏–ª–∏ ByeDPI!');
                            
                            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
                            if (!document.querySelector('.vpn-warning')) {
                                const warning = document.createElement('div');
                                warning.className = 'vpn-warning';
                                warning.innerHTML = `
                                    <div class="vpn-warning-title">‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: YouTube-–∫–æ–Ω—Ç–µ–Ω—Ç</div>
                                    <p class="vpn-warning-text">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç—Ç–æ–≥–æ –≤–∏–¥–µ–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤–∫–ª—é—á–∏—Ç—å VPN –∏–ª–∏ ByeDPI.</p>
                                `;
                                
                                const container = document.querySelector('.container');
                                container.insertBefore(warning, container.querySelector('.video-container'));
                            }
                        } else {
                            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
                            const warning = document.querySelector('.vpn-warning');
                            if (warning) {
                                warning.remove();
                            }
                        }
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º iframe —Å –≤–∏–¥–µ–æ
                        document.querySelector('.video-container iframe').src = new_video_url;
                        document.getElementById('new_video_url').value = '';
                        
                        // –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        tg.showPopup({
                            title: '–í–∏–¥–µ–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ',
                            message: '–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–Ω–∞—Ç—ã —Ç–µ–ø–µ—Ä—å –≤–∏–¥—è—Ç –Ω–æ–≤–æ–µ –≤–∏–¥–µ–æ.',
                            buttons: [{type: 'ok'}]
                        });
                    } else {
                        tg.showAlert(`–û—à–∏–±–∫–∞: ${data.error}`);
                    }
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞:', error);
                    tg.MainButton.hideProgress();
                    tg.showAlert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤–∏–¥–µ–æ');
                });
            });
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∏–¥–µ–æ
        document.getElementById('sync-btn').addEventListener('click', function() {
            // –§—É–Ω–∫—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ room.js
        });
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        const chatMessages = document.getElementById('chat-messages');
        
        // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
        if (!isBanned) {
            chatForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const message = messageInput.value.trim();
                if (!message) return;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ room.js
                if (typeof sendChatMessage === 'function') {
                    sendChatMessage(message);
                    messageInput.value = '';
                } else {
                    // –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ room.js –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
                    fetch('/webapp/send_message', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            room_id: roomId,
                            message: message,
                            user_id: userId
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                            messageInput.value = '';
                            
                            // –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ room.js –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é
                            const messageElement = document.createElement('div');
                            messageElement.className = 'message outgoing';
                            messageElement.setAttribute('data-timestamp', Math.floor(Date.now() / 1000));
                            messageElement.setAttribute('data-user-id', userId);
                            
                            const now = new Date();
                            const time = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                            
                            messageElement.innerHTML = `
                                <div class="message-bubble">${message}</div>
                                <div class="message-info">–í—ã, ${time}</div>
                            `;
                            
                            chatMessages.appendChild(messageElement);
                            
                            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º —á–∞—Ç –≤–Ω–∏–∑
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                            
                            // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—É—Å—Ç–æ–º —á–∞—Ç–µ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
                            const emptyMessage = document.querySelector('.empty-chat-message');
                            if (emptyMessage) {
                                emptyMessage.remove();
                            }
                        } else {
                            tg.showAlert(`–û—à–∏–±–∫–∞: ${data.error}`);
                        }
                    })
                    .catch(error => {
                        console.error('–û—à–∏–±–∫–∞:', error);
                        tg.showAlert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è');
                    });
                }
            });
        }
        
        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º —á–∞—Ç –≤–Ω–∏–∑ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        });
        
        // –°–ª—É—à–∞–µ–º —Å–æ–±—ã—Ç–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤–∏–¥–µ–æ
        function setupVideoTimeSync() {
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ room.js
            const checkInterval = setInterval(function() {
                if (typeof setVideoTime === 'function' && typeof getCurrentVideoTime === 'function') {
                    clearInterval(checkInterval);
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                    setInterval(function() {
                        fetch(`/webapp/check_sync?room_id=${roomId}&user_id=${userId}`)
                            .then(response => response.json())
                            .then(data => {
                                if (data.success && data.need_sync && data.time !== undefined) {
                                    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –±–æ–ª—å—à–µ 5 —Å–µ–∫—É–Ω–¥
                                    const currentTime = getCurrentVideoTime();
                                    if (Math.abs(currentTime - data.time) > 5) {
                                        setVideoTime(data.time);
                                        console.log('–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∏–¥–µ–æ —Å —Å–µ—Ä–≤–µ—Ä–æ–º:', data.time);
                                    }
                                }
                            })
                            .catch(error => {
                                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error);
                            });
                    }, 30000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
                }
            }, 2000);
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        setupVideoTimeSync();
    </script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º JavaScript –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–Ω–∞—Ç–æ–π -->
    <script src="{{ url_for('static', filename='webapp/room.js') }}"></script>
</body>
</html> 